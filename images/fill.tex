---
---

\tikzset{collection level 1/.style={
    collection,
    nodes={
        minimum width=5.75\masterunit,
        minimum height=2\masterunit,
    }
}}

\tikzset{collection level 2/.style={
    collection,
    nodes={
        minimum width=2\masterunit,
        minimum height=1\masterunit,
    }
}}

\tikzset{collection level 3/.style={
    collection,
    nodes={
        minimum width=.5\masterunit,
        minimum height=.5\masterunit,
    }
}}

\matrix (A) [collection level 1] {
    \node (a1) {}; &
    \elementsbetween[1] &
    \node (a2) {}; &
\\ };

\matrix (B1) [collection level 2] at (a1) {
    \node (b11) {}; &
    \elementsbetween[.75] &
    \node (b12) [minimum width=2\masterunit] {}; &
\\ };

\draw [flow width, dashed] ($ (B1.north west) + (-.25, .25) $) rectangle ($ (B1.south east) + (.25, -.25) $);

\matrix (B2) [collection level 2] at (a2) {
    \node (b21) {}; &
    \elementsbetween[.75] &
    \node (b22) [minimum width=2\masterunit] {}; &
\\ };

\draw [flow width, dashed] ($ (B2.north west) + (-.25, .25) $) rectangle ($ (B2.south east) + (.25, -.25) $);

\matrix (C1) [collection level 3] at (b11) {
    \node (c11) {\texttt{a}}; &
    \elementsbetween[.5] &
    \node (c12) {\texttt{a}}; &
\\ };

\matrix (C2) [collection level 3] at (b12) {
    \node (c21) {\texttt{a}}; &
    \elementsbetween[.5] &
    \node (c22) {\texttt{a}}; &
\\ };

\matrix (C3) [collection level 3] at (b21) {
    \node (c31) {\texttt{a}}; &
    \elementsbetween[.5] &
    \node (c32) {\texttt{a}}; &
\\ };

\matrix (C4) [collection level 3] at (b22) {
    \node (c41) {\texttt{a}}; &
    \elementsbetween[.5] &
    \node (c42) {\texttt{a}}; &
\\ };

\foreach \i in {1,...,4}{
    \measure[1]{$\texttt{n}_{\small{\texttt{m}}}$}{c\i1.north west}{c\i2.north east}
}
\foreach \i in {1,...,2}{
    \measure[1.25]{$\texttt{n}_{\small{\texttt{m-1}}}$}{b\i1.north west}{b\i2.north east}
}
\measure[1.25]{$\texttt{n}_{\small{\texttt{1}}}$}{a1.north west}{a2.north east}
